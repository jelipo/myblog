<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.springmarker.blog.dao.BlogMainDao">

    <select id="getWord" resultType="com.springmarker.blog.bean.BlogMainPojo">
        select * from word where permission=1
        <choose>
            <when test="type == '' "/>
            <when test="type == null "/>
            <when test="type == 0 "/>
            <otherwise>
                AND typeId=#{type}
            </otherwise>
        </choose>

        ORDER BY date DESC LIMIT #{startNum},#{getBlogNum};
    </select>

    <select id="toWord" resultType="com.springmarker.blog.bean.WordPojo">
        (SELECT * FROM word WHERE id &lt; #{0} ORDER BY id DESC LIMIT 1)
        union
        (SELECT * FROM word WHERE id = #{0} )
        union
        (SELECT * FROM word WHERE id &gt; #{0} LIMIT 1 )
    </select>

    <select id="getComments" resultType="com.springmarker.blog.bean.CommentPojo">
        select * from comment where wordId=#{0} ORDER BY isMainComment ,date;
    </select>

    <insert id="putReply" parameterType="java.util.HashMap" useGeneratedKeys="true">
        INSERT INTO comment(wordId,isMainComment,observerName,toObserverName,date,viceComment_mainComment_id,value,email)
        VALUE (#{wordId},#{isMainComment},#{observerName},#{toObserverName,jdbcType=VARCHAR},
          #{date},#{viceComment_mainComment_id,jdbcType=VARCHAR},#{value},#{email});
    </insert>

    <select id="getWordText" resultType="java.util.HashMap">
        select * from word_text where wordTextId=#{0} ;
    </select>

    <select id="getMessages" resultType="com.springmarker.blog.bean.MessagePojo">
        select * from message ORDER by date DESC limit 0,30 ;
    </select>

    <insert id="putMessage" useGeneratedKeys="true">
        INSERT INTO message(nick_name,date,content,contactway)
        VALUE (#{0},#{1},#{2},#{3});
    </insert>
</mapper>