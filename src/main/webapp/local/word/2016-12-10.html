<!DOCTYPE html><html><head><title>安装</title><meta charset='utf-8'><link href='https://dn-maxiang.qbox.me/res-min/themes/marxico.css' rel='stylesheet'><style></style></head><body><div id='preview-contents' class='note-content'>
                        
                    

<p><strong>Centos版本到7了，Mysql也到5.7了，改动蛮多的。之前一直懒得升级，最近由于升级强迫症犯了，然后就升级了，记录一下遇到的问题</strong></p>

<p>备份好了服务器上的各种文件，直接重装了系统（强迫症）。</p>



<h2 id="安装">安装</h2>

<p>首先看看自己系统有没有安装mysql的东西，有的话卸载掉。</p>

<p>进<a href="https://repo.mysql.com/" target="_blank">mysql的仓库看看</a>，目前最新的mysql的yum源是<a href="https://repo.mysql.com/mysql57-community-release-el7-9.noarch.rpm" target="_blank">https://repo.mysql.com/mysql57-community-release-el7-9.noarch.rpm</a>这个，直接输入 </p>

<pre class="prettyprint hljs-dark"><code class="hljs groovy">wget <span class="hljs-string">https:</span><span class="hljs-comment">//repo.mysql.com/mysql57-community-release-el7-9.noarch.rpm</span><br></code></pre>

<p>执行</p>



<pre class="prettyprint hljs-dark"><code class="hljs sql">sudo yum <span class="hljs-operator"><span class="hljs-keyword">install</span> mysql-<span class="hljs-keyword">server</span></span><br></code></pre>

<p>会下载190m左右的内容，同时会检查依赖关系，出现问题根据提示解决依赖。</p>

<h2 id="设置mysql-1">设置mysql</h2>

<p>安装完成后，安装程序自动给系统添加了一个mysqld service。 <br>
启动mysql(cetnos7也把service命令换成了systemctl)</p>

<pre class="prettyprint hljs-dark"><code class="hljs crmsh">systemctl <span class="hljs-literal">start</span> mysqld.service<br></code></pre>

<p>接下来，密码的问题才是坑啊，之前安装mysql的时候安装完没有密码，直接输入mysql进去就可以了，到了5.7，默认是有密码的，我在这栽了跟头，还一直以为没装好啥的，装了好几遍，怎么输密码都不对。</p>

<p>新版的mysql安装完成之后会在/var/log 路径下生成mysqld.log的文件，同时会生成一个本地的随机密码。 <br>
 用vim打开然后输入 / 输入 password 查找 “password”关键词</p>

<pre class="prettyprint hljs-dark"><code class="hljs lasso">vim /<span class="hljs-built_in">var</span>/<span class="hljs-keyword">log</span>/mysqld<span class="hljs-built_in">.</span><span class="hljs-keyword">log</span><br></code></pre>

<pre class="prettyprint hljs-dark"><code class="language-bash hljs">A temporary password is generated <span class="hljs-keyword">for</span> root@localhost:*******<br></code></pre>

<p>*号为生成的密码</p>

<p>然后就可以顺利的进mysql了</p>

<pre class="prettyprint hljs-dark"><code class="hljs nginx"><span class="hljs-title">mysql</span> -u root -p<br></code></pre>

<p>提示输入密码，把刚才找到的密码输入进去就可以了。进入后，肯定先修改密码。 <br>
（5.7的密码更加严格了，不达到要求是不能设置成功的，不过可以设置mysql的密码强度，此处不多说）</p>

<pre class="prettyprint hljs-dark"><code class="hljs actionscript">mysql&gt;<span class="hljs-keyword">set</span> password = password(<span class="hljs-string">'你的密码'</span>）;<br></code></pre>

<p>如果要设置root允许所有ip访问的话，输入</p>

<pre class="prettyprint hljs-dark"><code class="hljs lasso">mysql&gt;grant <span class="hljs-literal">all</span> privileges <span class="hljs-keyword">on</span> *<span class="hljs-built_in">.</span>* <span class="hljs-keyword">to</span> root@<span class="hljs-string">'%'</span>identified <span class="hljs-keyword">by</span> <span class="hljs-string">'你的密码'</span>;<br></code></pre>

<p>成功后输入exit退出，重启mysql</p>



<pre class="prettyprint hljs-dark"><code class="hljs css"><span class="hljs-tag">systemctl</span> <span class="hljs-tag">restart</span> <span class="hljs-tag">mysqld</span><span class="hljs-class">.service</span><br></code></pre>

<p>这样mysql基本就安装完成了。</p>

<p>远程登陆试试，发现怎么也连不上，估计是防火墙问题，cetnos7里面用firewalld代替了iptable，不过也可以换回iptable。 <br>
输入命令开启3306端口</p>

<pre class="prettyprint hljs-dark"><code class="language-bash hljs">firewall-cmd --zone=public --add-port=<span class="hljs-number">3306</span>/tcp --permanent<br></code></pre>

<p>重新载入</p>



<pre class="prettyprint hljs-dark"><code class="language-bash hljs">firewall-cmd --reload<br></code></pre>

<p>重新远程连接，success。</p>



<h2 id="一点安全">一点安全</h2>

<p>远程直连的话，就意味着，mysql的端口就得暴露出来给外网，如果要远程看数据库的话，而且客户端是桌面的话，可以试试navicat的ssh登录功能（其它客户端有的也有此功能，看个人爱好），这样就不用把3306端口暴露给外网了，同样也可以访问服务器内网中的mysql。</p></div></body></html>